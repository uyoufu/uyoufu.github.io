<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0-rc1">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"galens.uamazing.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.16.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"flat"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":true,"pangu":true,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="本文简要介绍计算机图图形学中的常用的各个样条曲线，同时梳理他们的之间的关系。">
<meta property="og:type" content="article">
<meta property="og:title" content="由浅入深地理解样条曲线">
<meta property="og:url" content="https://galens.uamazing.cn/posts/2022/1CPW2GG.html">
<meta property="og:site_name" content="星辰大海">
<meta property="og:description" content="本文简要介绍计算机图图形学中的常用的各个样条曲线，同时梳理他们的之间的关系。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://obs.uamazing.cn:52443/public/files/images/image-20220705222132936.png">
<meta property="og:image" content="https://obs.uamazing.cn:52443/public/files/images/image-20220707133020413.png">
<meta property="og:image" content="https://obs.uamazing.cn:52443/public/files/images/image-20220707134509292.png">
<meta property="article:published_time" content="2022-05-11T16:00:00.000Z">
<meta property="article:modified_time" content="2022-07-05T16:00:00.000Z">
<meta property="article:author" content="明不知昔">
<meta property="article:tag" content="Bentley二次开发">
<meta property="article:tag" content="Bentley">
<meta property="article:tag" content="galens">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://obs.uamazing.cn:52443/public/files/images/image-20220705222132936.png">


<link rel="canonical" href="https://galens.uamazing.cn/posts/2022/1CPW2GG.html">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://galens.uamazing.cn/posts/2022/1CPW2GG.html","path":"posts/2022/1CPW2GG.html","title":"由浅入深地理解样条曲线"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>由浅入深地理解样条曲线 | 星辰大海</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="星辰大海" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">星辰大海</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">人生万事须自为，跬步江山即寥廓</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">210</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">109</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">373</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BFb%C3%A9zier-curve"><span class="nav-number">2.</span> <span class="nav-text">贝塞尔曲线（Bézier curve）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-number">2.1.</span> <span class="nav-text">定义</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="nav-number">2.1.1.</span> <span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E5%AE%83%E8%AF%B4%E6%98%8E"><span class="nav-number">2.1.2.</span> <span class="nav-text">其它说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E8%B4%9D%E5%A1%9E%E5%B0%94%E6%9B%B2%E7%BA%BF"><span class="nav-number">2.1.3.</span> <span class="nav-text">线性贝塞尔曲线</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%82%E5%BD%A2%E6%9B%B2%E7%BA%BF"><span class="nav-number">2.1.4.</span> <span class="nav-text">异形曲线</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%B4%A8"><span class="nav-number">2.2.</span> <span class="nav-text">性质</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#b%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BFb-spline"><span class="nav-number">3.</span> <span class="nav-text">B样条曲线（B-Spline）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-number">3.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%90%86%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">理解</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%82%E6%95%B0"><span class="nav-number">3.2.1.</span> <span class="nav-text">参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-number">3.2.2.</span> <span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%90%91%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">3.3.</span> <span class="nav-text">节点向量的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%90%91%E9%87%8F%E7%9A%84%E5%8F%96%E5%80%BC"><span class="nav-number">3.4.</span> <span class="nav-text">节点向量的取值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E5%90%91%E9%87%8F%E7%9A%84%E6%AD%A5%E9%95%BF%E5%8F%96%E5%80%BC"><span class="nav-number">3.5.</span> <span class="nav-text">节点向量的步长取值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8A%82%E7%82%B9%E7%9A%84%E4%B8%AA%E6%95%B0%E7%A1%AE%E5%AE%9A"><span class="nav-number">3.6.</span> <span class="nav-text">节点的个数确定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%89%E6%95%88%E5%AE%9A%E4%B9%89%E5%8C%BA%E9%97%B4"><span class="nav-number">3.7.</span> <span class="nav-text">有效定义区间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b-%E6%A0%B7%E6%9D%A1%E6%9C%AC%E8%B4%A8"><span class="nav-number">3.8.</span> <span class="nav-text">b 样条本质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E8%B4%A8-1"><span class="nav-number">3.9.</span> <span class="nav-text">性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">3.10.</span> <span class="nav-text">分类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9D%87%E5%8C%80uniform-b-%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF"><span class="nav-number">3.11.</span> <span class="nav-text">均匀（uniform） b 样条曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%87%86%E5%9D%87%E5%8C%80quasi-uniform-b-%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF"><span class="nav-number">3.12.</span> <span class="nav-text">准均匀（quasi-uniform） b
样条曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E6%AE%B5-bezier-%E6%9B%B2%E7%BA%BF"><span class="nav-number">3.13.</span> <span class="nav-text">分段 Bezier 曲线</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B2%E7%BA%BF%E5%8C%85%E5%90%AB%E7%BA%BF%E6%AE%B5"><span class="nav-number">3.14.</span> <span class="nav-text">曲线包含线段</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B2%E7%BA%BF%E7%BB%8F%E8%BF%87%E6%8E%A7%E5%88%B6%E7%82%B9"><span class="nav-number">3.15.</span> <span class="nav-text">曲线经过控制点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B2%E7%BA%BF%E4%B8%8E%E6%9F%90%E7%9B%B4%E7%BA%BFl%E7%9B%B8%E5%88%87"><span class="nav-number">3.16.</span> <span class="nav-text">曲线与某直线L相切</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%97%AD%E6%9B%B2%E7%BA%BF"><span class="nav-number">3.17.</span> <span class="nav-text">闭曲线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9D%9E%E5%9D%87%E5%8C%80%E6%9C%89%E7%90%86b%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BFnurbs"><span class="nav-number">4.</span> <span class="nav-text">非均匀有理B样条曲线（NURBS）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#order%E9%98%B6%E6%95%B0"><span class="nav-number">4.1.</span> <span class="nav-text">Order（阶数）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#control-point-%E4%B8%8E-knot"><span class="nav-number">4.2.</span> <span class="nav-text">Control Point 与 Knot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weight"><span class="nav-number">4.3.</span> <span class="nav-text">Weight</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#b%C3%A9zierb-splinenurbs-%E5%8C%BA%E5%88%AB"><span class="nav-number">5.</span> <span class="nav-text">Bézier、B-Spline、NURBS 区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#msbsplinecurvemicrostation%E4%B8%AD%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">6.</span> <span class="nav-text">MSBsplineCurve（Microstation中的对象）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pole-and-knot-counts"><span class="nav-number">6.1.</span> <span class="nav-text">Pole and knot counts</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#b%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF%E4%B8%8A%E7%9A%84%E5%8F%82%E6%95%B0%E5%8C%96%E4%BD%8D%E7%BD%AE"><span class="nav-number">6.2.</span> <span class="nav-text">B样条曲线上的参数化位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E6%8E%A7%E5%88%B6%E7%82%B9%E7%9A%84-b-%E6%A0%B7%E6%9D%A1%E6%9B%B2%E7%BA%BF"><span class="nav-number">6.3.</span> <span class="nav-text">通过控制点的 b 样条曲线</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BA%90%E4%BB%A3%E7%A0%81"><span class="nav-number">7.</span> <span class="nav-text">源代码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">8.</span> <span class="nav-text">参考</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="明不知昔"
      src="https://s2.loli.net/2022/02/13/nA5l6TkJMgNmtxr.png">
  <p class="site-author-name" itemprop="name">明不知昔</p>
  <div class="site-description" itemprop="description">人生万事须自为，跬步江山即寥廓</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">373</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">109</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">210</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/galensgan" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;galensgan" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.jianshu.com/u/08760e791f9e" title="简  书 → https:&#x2F;&#x2F;www.jianshu.com&#x2F;u&#x2F;08760e791f9e" rel="noopener me" target="_blank"><i class="fa fa-book-reader fa-fw"></i>简  书</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://galens.uamazing.cn/posts/2022/1CPW2GG.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://s2.loli.net/2022/02/13/nA5l6TkJMgNmtxr.png">
      <meta itemprop="name" content="明不知昔">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="星辰大海">
      <meta itemprop="description" content="人生万事须自为，跬步江山即寥廓">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="由浅入深地理解样条曲线 | 星辰大海">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          由浅入深地理解样条曲线
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2022-05-12 00:00:00" itemprop="dateCreated datePublished" datetime="2022-05-12T00:00:00+08:00">2022-05-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-07-06 00:00:00" itemprop="dateModified" datetime="2022-07-06T00:00:00+08:00">2022-07-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bentley/" itemprop="url" rel="index"><span itemprop="name">Bentley</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bentley/Develop/" itemprop="url" rel="index"><span itemprop="name">Develop</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bentley/Develop/%E5%87%A0%E4%BD%95%E5%8F%98%E6%8D%A2/" itemprop="url" rel="index"><span itemprop="name">几何变换</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>本文简要介绍计算机图图形学中的常用的各个样条曲线，同时梳理他们的之间的关系。</p>
<span id="more"></span>
<h2 id="前言">前言</h2>
<p>在阅读本文之前，请先静下心来，一步一步理解公式，不要因公式复杂而望而却步。如果慢慢理解，它其实也挺简单。</p>
<p>对于下列形式的公式说明： <span class="math display">\[
\begin{equation}
P(t) = \sum_{i=0}^{n}P_iB_{i}(t)
\end{equation}
\]</span> 上述公式表示 <span class="math inline">\(P_t\)</span>
是通过将多个点乘以一个函数 <span
class="math inline">\(B_i(t)\)</span>相加求得，这个公式的可以理解成曲线上的每个点
<span class="math inline">\(P_t\)</span> 是 n 维线性空间中的点，<span
class="math inline">\(B_i(t)\)</span> 是线性空间中的基函数。</p>
<p>n 维线性空间不是指笛卡尔坐标系下的 n
维，而是线性代数上的维度，如果对这个概念不是很清楚，可以查阅相关书籍，当然，上述的这个理解方式也可以忽略。</p>
<h2 id="贝塞尔曲线bézier-curve">贝塞尔曲线（Bézier curve）</h2>
<p><a target="_blank" rel="noopener" href="https://www.jasondavies.com/animated-bezier/"><img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220513132345112.png"
alt="点击图片可查看动画" /></a></p>
<h3 id="定义">定义</h3>
<p><span class="math display">\[
\begin{split}
P(t) &amp;= \sum_{i=0}^{n}P_i \cdot B_{i,n}(t),t \in [0,1] \\
B_{i,n}(t) &amp;=
C_n^it^i(1-t)^{n-i}=\frac{n!}{i!(n-i)!}t^i(1-t)^{n-i},i
\in[0,1,\cdot\cdot\cdot,n]
\end{split}
\]</span> ### 理解</p>
<h4 id="参数说明">参数说明</h4>
<ol type="1">
<li><p><span class="math inline">\(t\)</span></p>
<p>参数 <span class="math inline">\(t\)</span> 是隐函数 <span
class="math inline">\(P(t)\)</span> 的参数，它的值域是
[0,1]，在计算机中，通过将 <span class="math inline">\(t\)</span> 从 0
递增到 1，来生成贝塞尔曲线上的点，因此 <span
class="math inline">\(t\)</span> 的步长越短，其生成的曲线越光滑</p></li>
<li><p><span class="math inline">\(P_i\)</span></p>
<p><span class="math inline">\(P_i\)</span> 是由用户给定的控制点，下标
<span class="math inline">\(i\)</span> 代表点的顺序</p></li>
<li><p><span class="math inline">\(C_n^i\)</span></p>
<p><span class="math inline">\(C_n^i\)</span> 称为二项式系数。</p>
<p>二项式展开定义如下： <span class="math display">\[
\begin{split}
(a+b)^n = \sum_i^n C_n^i a^{n-i} b^i
\end{split} = \sum_i^n \frac{n!}{i!(n-i)!}\cdot a^{n-i} \cdot b^i
\]</span></p></li>
<li><p><span class="math inline">\(B_{i,n}(t)\)</span></p>
<p>这个叫做贝塞尔曲线的基函数，它的计算公式见上面的公式。<span
class="math inline">\(\sum_i^n B_{i,n}(t)\)</span> 是二项式 <span
class="math inline">\((t+(1-t))^n\)</span> 的展开公式。</p>
<p><span class="math inline">\(i\)</span> 代表点的序号，从 0 开始；<span
class="math inline">\(n\)</span> 叫次数（degree）。</p>
<p>如果点的数量为 p，则 <span class="math inline">\(n\)</span> 与 <span
class="math inline">\(p\)</span> 的关系为 <span
class="math inline">\(n=p-1\)</span>。</p></li>
</ol>
<h4 id="其它说明">其它说明</h4>
<ol type="1">
<li>一条贝塞尔曲线是由多个控制点共同决定的，n（次数）决定了生成一条曲线需要使用多少个控制点。</li>
<li>复杂形状通常要将多条贝塞尔曲线拼接在一起表达。</li>
</ol>
<h4 id="线性贝塞尔曲线">线性贝塞尔曲线</h4>
<p>线性曲线的次数为1，其所需要的控制点为 2 个，假设为 <span
class="math inline">\(P_0,P_1\)</span> <span class="math display">\[
\begin{split}
P(t) &amp;= \sum_{i=0}^{n}P_iB_{i,n}(t)=P_0 B_{0,1}(t)+P_1 B_{1,1}(t) \\
\therefore P_t &amp;= P_0 \cdot \frac{1!}{0!(1-0)!}t^0(1-t)^{1-0}+
P_1 \cdot \frac{1!}{1!(1-1)!}t^1(1-t)^{1-1} \\
&amp; 又 \because 0! = 1 \\
\therefore P_t &amp;= P_0 \cdot (1-t)+P1\cdot t = P_0+t\cdot(P_1-P_0)
\end{split}
\]</span></p>
<h4 id="异形曲线">异形曲线</h4>
<p>为了能够表达复杂的异形曲线，我们将多条贝塞尔曲线连接在一起，在连接处保证其几何连续，这样就形成了一条复杂的贝塞尔曲线了。</p>
<h3 id="性质">性质</h3>
<ol type="1">
<li><p>各项系数之和为1 这个很好理解,因为系数 <span
class="math inline">\(\sum_i^n B_{i,n}(t)\)</span> 是二项式 <span
class="math inline">\((t+(1-t))^n\)</span> 的展开，所以其值始终为
1</p></li>
<li><p>对称性 第 <span class="math inline">\(i\)</span> 项系数和倒数第
<span class="math inline">\(i\)</span> 项系数（即 <span
class="math inline">\(n-i\)</span> 项）相同</p></li>
<li><p>递归性 递归性指其系数满足下式： <span class="math display">\[
B{i,n}(t) = (1-t)B_{i,n-1}(t)+tB_{i-1,n-1}(t),i \in
[0,1,\cdot\cdot\cdot,n]
\]</span></p></li>
<li><p>凸包性质
贝塞尔曲线始终会在<strong>包含了所有控制点的最小凸多边形</strong>中，不是按照控制点的顺序围成的最小多边形。这点大家一定注意。</p>
<p>这一点的是很关键的，也就是说可以通过控制点的凸包来限制规划曲线的范围，在路径规划是很需要的一个性质。</p></li>
<li><p>端点性质
第一个控制点和最后一个控制点，恰好是曲线的起始点和终点。这一点可以套用二项式展开来理解，ｔ＝１或者０的时候，相乘二项式的系数，除了初始点或者末尾点，其余的都是０。</p></li>
<li><p>一阶导数性质</p></li>
</ol>
<h2 id="b样条曲线b-spline">B样条曲线（B-Spline）</h2>
<p>贝塞尔曲线有很多优点，但也有几个不足之处：</p>
<p>（1）一旦确定了特征多边形的顶点数，就决定了曲线的阶数。当数据点的数量太多时，计算量急剧增加。</p>
<p>（2）由于光滑性很高，反而导致拼接比较复杂。</p>
<p>（3）无法做局部修改，这是一个很大的局限性，牵一发而动全身。</p>
<p>1972年，在贝塞尔提出他的方法十年后，Gordon和Riesenfeld等人又提出了B样条方法，在保留了贝塞尔方法的全部优点的同时，克服了以上三大缺点。</p>
<p>B样条曲线有如下性质：</p>
<ol type="1">
<li>可以指定阶次</li>
<li>移动控制点仅仅改变曲线的部分形状，而不是整体</li>
</ol>
<h3 id="定义-1">定义</h3>
<p>b 样条曲线有很多种定义方式，相对简单的表达是 de Boor-Cox
递归公式，其定义如下：</p>
$$
<span class="math display">\[\begin{split}
P(t) &amp;= \sum_{i=0}^{n}P_i \cdot N_{i,k}(t),t \in [t_{k-1},t_{n+1}]
\\

N_{i,1}(t) &amp;= \left\{
\begin{array}{left}
1 \ ,t_i&lt;t&lt;t_{i+1} \\
0 \ ,Otherwise
\end{array}
\right.  ，注意，N_{i,1}(t) 中的 1 代表阶\\

N_{i,k}(t) &amp;=\frac{t-t_i}{t_{i+k-1}-t_i}\cdot
N_{i,k-1}(t)+\frac{t_{i+k}-t}{t_{i+k}-t_{i+1}}\cdot N_{i+1,k-1}(t) \\

&amp; 同时约定: \frac{0}{0} = 0
\end{split}\]</span>
<p>$$</p>
<h3 id="理解">理解</h3>
<h4 id="参数">参数</h4>
<ol type="1">
<li><p><span class="math inline">\(P(t)\)</span></p>
<p>曲线上的点</p></li>
<li><p>t</p>
<p>隐式方程的参数，与贝塞尔曲线的 t 相同</p></li>
<li><p><span class="math inline">\(P(i)\)</span></p>
<p>用户给定的控制点</p></li>
<li><p>n</p>
<p>控制点数组中下标的最大值，其值等于控制点的总数减 1</p></li>
<li><p>i</p>
<p>每一个控制点的下标</p></li>
<li><p>k</p>
<p>代表 b 样条曲线的阶数。</p>
<p>阶数的表达的意义是：</p>
<ul>
<li><strong>b 样条必须有 k 个基函数才有意义</strong></li>
<li>每个基函数的定义域跨越了 k 个区间</li>
</ul>
<p>特别注意，上面的表达式中用的是阶，而在有的文章里面，是用次来表示的，阶与次都是同一个概念，只是它们的值不一样，阶(order)=次(degree)+1。</p>
<p>为什么会出现阶和次两种表达方式呢？</p>
<p>在图形学中，有两个很著名的教授，一个叫 G Farin，一个叫 Les
Piegl，他们分别是 Computer Aided Geometric Design 和 Computer Aided
Design 杂志的主编。这两位主编分别写了一本书，G Farin 叫 k 阶 b
样条曲线，Les Piegl 叫 k 次 b 样条曲线。</p>
<p>这两个概念大家都在用，所以就导致了这种不同名称的定义。</p></li>
<li><p><span class="math inline">\(N_{i,k}(t)\)</span></p>
<p>表示第 <span class="math inline">\(i\)</span> 个 <span
class="math inline">\(k\)</span>
阶（order）B样条基函数。它是由节点向量（knot vector）唯一决定的。</p>
<p><strong>特别注意，上面的分段函数是 <span
class="math inline">\(N_{i,1}(t)\)</span></strong></p>
<p>通过 <span class="math inline">\(N_{i,k}(t)\)</span>
的公式，我们可以作如下推导： <span class="math display">\[
\begin{split}
N_{i,k}(t) &amp;=\frac{t-t_i}{t_{i+k-1}-t_i}\cdot
N_{i,k-1}(t)+\frac{t_{i+k}-t}{t_{i+k}-t_{i+1}}\cdot N_{i+1,k-1}(t)
\\
&amp;= \frac{t-t_i}{t_{i+(k-1)}-t_i}\cdot N_{i,k-1}(t) +
\frac{t_{(i+1)+(k-1)}-t}{t_{(i+1)+(k-1)}-t_{i+1}}\cdot N_{i+1,k-1}(t)
\end{split}
\]</span> 通过上式，可以知 <span
class="math inline">\(N_{i,k}(t)\)</span> 其实是 <span
class="math inline">\(N_{i,k-1}(t)\)</span> 在区间 <span
class="math inline">\([t_i,t_{i+k-1}]\)</span> 上的插值加上 <span
class="math inline">\(N_{i+1,k-1}(t)\)</span> 在区间 <span
class="math inline">\([t_{i+1},t_{i+1+k-1}]\)</span> 上的插值。</p>
<p>更通俗地讲就是，第 i 个 k 阶基函数是第 i 和 i+1 个 k-1
阶基函数的线性插值。</p></li>
<li><p>节点向量</p>
<p>设 T 是 m+ 1 个非递减数的集合，<span class="math inline">\(t_0 &lt;=
t_1 &lt;= t_2&lt;= ... &lt;= t_m\)</span>。<span
class="math inline">\(t_i\)</span>称为<strong>节点（knots）</strong>,
集合 T 称为<strong>节点向量（knot vector）</strong>, 半开区间 <span
class="math inline">\([t_i,t_{i+1}]\)</span> 是第 <em>i</em>
个节点区间（<em>knot span</em>）</p>
<p>节点向量本质就是一组非减的实数序列，一般取 [0,1]。</p>
<p>看到此处，可能会很疑惑，为什么需要定义节点向量，节点向量有什么作用呢？后文将会一一道来。</p></li>
<li><p>重复度</p>
<p>在节点向量（节点数组）中，如果某一个节点连续出现 m
次，则称该节点的重复度为 m。</p></li>
</ol>
<h4 id="示例">示例</h4>
<p>为了方便理解 b样条曲线，我们先计算一些低阶曲线。</p>
<ol type="1">
<li><p>第 0 个 1 阶基函数 <span
class="math inline">\(N_{0,1}（i=0,k=1）\)</span></p>
<p>当 <span class="math inline">\(t_i&lt;t&lt;t_{i+1}\)</span> 时，即
<span class="math inline">\(t_i\)</span> 在区间 <span
class="math inline">\([t_0,t1]\)</span> 上时，有：</p></li>
</ol>
<p><span class="math display">\[
\begin{equation}
N_{0,1}(t) = \left\{
\begin{array}{left}
1 \ ,t_0&lt;t&lt;t_{1} \\
0 \ ,Otherwise
\end{array}
\right.
\end{equation}
\]</span></p>
<ol start="2" type="1">
<li><p>第 1 个 1 阶基函数 <span
class="math inline">\(N_{1,1}（i=1,k=1）\)</span> <span
class="math display">\[
\begin{equation}
N_{1,1}(t) = \left\{
\begin{array}{left}
1 \ ,t_1&lt;t&lt;t_{2} \\
0 \ ,Otherwise
\end{array}
\right.
\end{equation}
\]</span></p></li>
<li><p>第 0 个 2 阶基函数 <span
class="math inline">\(N_{0,2}（i=0,k=2）\)</span> <span
class="math display">\[
\begin{split}
N_{0,2}(t) = \frac{t-t_0}{t_1-t_0}\cdot N_{0,1}(t) +
\frac{t_2-t}{t_2-t_1}\cdot N_{0,1}(t)
\end{split}
\]</span></p></li>
</ol>
<h3 id="节点向量的作用">节点向量的作用</h3>
<p>首先抛出一个定义，节点向量是对 <span class="math inline">\(t\)</span>
定义域的一个划分。</p>
<p>因为节点向量是是分段的，基函数在仅在某些段上有值，所以公式 <span
class="math inline">\(P(t) = \sum_{i=0}^{n}P_i \cdot N_{i,k}(t)\)</span>
中实际参与组合的点并不是全部（实际上只有 k 个，文会详细解释）。</p>
<p>因此，节点区间通过控制基函数是否为 0，来确定计算 b
样条曲线上的点时，采用哪些控制点。</p>
<p>在生成曲线的时候，将 t
从小到大变化，从而得到曲线上的一系列点，它的详细步骤如下：</p>
<ol type="1">
<li>根据 t，确定 t 所在的节点区间 <span
class="math inline">\(T_i\)</span></li>
<li>通过迭代公式，求出每个点在该区间（<span
class="math inline">\(T_i\)</span>）上的基函数</li>
<li>将每个基函数与对应的控制点相乘取和，得到曲线上实际的点</li>
</ol>
<h3 id="节点向量的取值">节点向量的取值</h3>
<p>上文讲到节点向量是一组非减实数序列，从插值公式中可以知道，向量中的每个节点大小不会影响结果，影响结果的是两个节点的步长。</p>
<p>因此，节点向量可以是任意实数序列。</p>
<p>那么步长怎么确定呢？</p>
<h3 id="节点向量的步长取值">节点向量的步长取值</h3>
<p>上面一节讲到，b
样条上每个点只与节点向量的步长有关，因此，根据设置不同的步长，b
样条就会产生不同的效果。</p>
<p>如果节点向量没有任何特别的结构，那么产生的曲线不会与控制折线（<em>polyline</em>）的第一边（<em>leg</em>）和最后一边（<em>leg</em>）接触，如下面图所示。</p>
<figure>
<img data-src="http://www.cs.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/B-spline/bs-cv-open-1.jpg"
alt="open" />
<figcaption aria-hidden="true">open</figcaption>
</figure>
<p>这种类型的<em>B-</em>样条曲线称为开（<strong>open</strong> ）b
样条曲线。</p>
<p>我们可能想强制曲线使得它分别与第一个控制点和最后一个控制点的第一边和最后一边相切，像贝塞尔曲线那样。为了做到这些，第一个节点和最后一个节点必须是重复度为
<span class="math inline">\(k(代表阶数)\)</span>。这就产生了所谓的
<strong>clamped</strong> b 样条曲线。参见下图。</p>
<figure>
<img data-src="http://www.cs.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/B-spline/bs-cv-clamped-1.jpg"
alt="clamped" />
<figcaption aria-hidden="true">clamped</figcaption>
</figure>
<p>通过重复某些节点和控制点，产生的曲线会是闭（<strong>closed</strong>）曲线。
这种情况，产生的曲线的开始和结尾连接在一起形成了一个闭环如下图所示。</p>
<figure>
<img data-src="http://www.cs.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/B-spline/bs-cv-closed-1.jpg"
alt="close" />
<figcaption aria-hidden="true">close</figcaption>
</figure>
<h3 id="节点的个数确定">节点的个数确定</h3>
<p>从公式定义中，可以得知，第 i 个 k 阶 b 样条曲线的基函数等于第 i 个
k-1 阶基函数和第 i+1 个 k-1
阶基函数的线性插值。它们的关系可以用下图来表示。</p>
<p><img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220705222132936.png" style="max-width:400px"></p>
<p>从上图中，我们可以看到，如果要求第 0 个 5 阶 b 样条函数基函数，则需要
5 个 1 阶基函数，需要 6 个节点。由此，可以得到如下结论： <span
class="math display">\[
结点数量(KnotsCount) = 控制点数量(PointCount)+阶数k(order)
\]</span></p>
<h3 id="有效定义区间">有效定义区间</h3>
<p>上面在解释 k 这个符号的时候，提到了 k 阶的概念。</p>
<p>一个 k 阶 b 样条，它必须有 k 个基函数才有意义，所以，一个 b
样条曲线的有效定义区间必须包含 k 个 基函数定义。</p>
<p>从公式 <span class="math display">\[
\begin{split}
   P(t) = \sum_{i=0}^{n}P_i \cdot N_{i,k}(t),t \in [t_{k-1},t_{n+1}]
   \end{split}
\]</span>
可以看出，曲线上的点是通过每个点乘以其基函数然后进行相加，从3.6节的计算图中我们可以看到，每个点的基函数的计算仅使用了有限个区间，比如
<span class="math inline">\(N_{0,2}(t)\)</span> 使用的区间为 <span
class="math inline">\([t_0,t_2)\)</span>。</p>
<p>因此，我们可以将一个高阶基函数用 1 阶基函数来表示： <span
class="math display">\[
\begin{split}
   N_{i,k}(t) &amp;= \sum_{i}^{i+k-1}C_i(t) \cdot N_{i,1}(t), \ t \in
[t_i,t_{i+k}) \\
  C_{i}(t) &amp;-一阶基函数系数
   \end{split}
\]</span></p>
<p>从上式可以看出，k 阶基函数跨越了 <span class="math inline">\((i+k)-i
= k\)</span> 个区间。</p>
<p>假设一个 4 阶 b 样条有 5
个控制点，其基函数的区间可以用下图来表示：</p>
<figure>
<img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220707124032974.png"
alt="image-20220707124032974" />
<figcaption aria-hidden="true">image-20220707124032974</figcaption>
</figure>
<p>从图中我们发现，仅在 <span class="math inline">\([t_3,t_5]\)</span>
区间上存在 4 个基函数，所以仅在该区间上，b 样条曲线才有定义。</p>
<p>推而广之，我们就得到，一个有 (n+1) 个控制点的 k 阶 b
样条曲线的有效定义区间为 <span
class="math inline">\([t_{k-1},t_{n+1}]\)</span>。</p>
<h3 id="b-样条本质">b 样条本质</h3>
<p>b 样条曲线的本质是由多个 k-1 次多项式组合而成，这些分段曲线之间 k-2
次连续。</p>
<p>假设一个 4 阶 b 样条有 5 个控制点，任意点公式可以写成： <span
class="math display">\[
\begin{split}
   P(t) =
N_{0,k}(t)P_0+N_{1,k}(t)P_1+N_{2,k}(t)P_2+N_{3,k}(t)P_3+N_{4,k}(t)P_4
\end{split}
\]</span> 由于是 4 阶 5 点，所以有 9 个节点，8
个节点区间，因此可以画出基函数的有效区间图如下：</p>
<figure>
<img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220707124032974.png"
alt="image-20220707124032974" />
<figcaption aria-hidden="true">image-20220707124032974</figcaption>
</figure>
<p>所以，可以得到下列分段函数</p>
<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 12%" />
<col style="width: 70%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th>区间序号</th>
<th>定义域</th>
<th>公式</th>
<th>有效性</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><span class="math inline">\([t_0,t_1)\)</span></td>
<td><span class="math inline">\(P(t) = N_{0,k}(t)P_0\)</span></td>
<td>无效</td>
</tr>
<tr class="even">
<td>2</td>
<td><span class="math inline">\([t_1,t_2)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{0,k}(t)P_0+N_{1,k}(t)P_1\)</span></td>
<td>无效</td>
</tr>
<tr class="odd">
<td>3</td>
<td><span class="math inline">\([t_2,t_3)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{0,k}(t)P_0+N_{1,k}(t)P_1+N_{2,k}(t)P_2\)</span></td>
<td>无效</td>
</tr>
<tr class="even">
<td>4</td>
<td><span class="math inline">\([t_3,t_4)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{0,k}(t)P_0+N_{1,k}(t)P_1+N_{2,k}(t)P_2+N_{3,k}(t)P_3\)</span></td>
<td>有效</td>
</tr>
<tr class="odd">
<td>5</td>
<td><span class="math inline">\([t_4,t_5)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{1,k}(t)P_1+N_{2,k}(t)P_2+N_{3,k}(t)P_3+N_{4,k}(t)P_4\)</span></td>
<td>有效</td>
</tr>
<tr class="even">
<td>6</td>
<td><span class="math inline">\([t_5,t_6)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{3,k}(t)P_3+N_{4,k}(t)P_4\)</span></td>
<td>无效</td>
</tr>
<tr class="odd">
<td>7</td>
<td><span class="math inline">\([t_6,t_7)\)</span></td>
<td><span class="math inline">\(P(t) =
N_{3,k}(t)P_3+N_{4,k}(t)P_4\)</span></td>
<td>无效</td>
</tr>
<tr class="even">
<td>8</td>
<td><span class="math inline">\([t_7,t_8)\)</span></td>
<td><span class="math inline">\(P(t) = N_{4,k}(t)P_4\)</span></td>
<td>无效</td>
</tr>
</tbody>
</table>
<p>从表中可以看出，5个控制点的 4 阶 b样条曲线仅在第 4 和 5
个节点区间上生成曲线。</p>
<h3 id="性质-1">性质</h3>
<ol type="1">
<li><p>非负性</p>
<p><span class="math inline">\(N_{i,k}(t)\)</span> 是非负的</p></li>
<li><p>局部支持性</p>
<ul>
<li>区间 <span class="math inline">\([t_i,t_i+1]\)</span>
上的曲线仅至多由 k 个控制</li>
</ul></li>
</ol>
<ul>
<li><p><span class="math inline">\(P_j,j \in [i-k+1,...,i]\)</span>
决定</p></li>
<li><p><span class="math inline">\(P_i\)</span> 只影响在区间 <span
class="math inline">\([t_i,t_i+k)\)</span> 上的曲线。</p></li>
</ul>
<ol type="1">
<li><p>归一性</p>
<p>区间 <span class="math inline">\([t_{k-1},t_{n+1}]\)</span> 上的所有
k 阶分段非零基函数的和为 1 <span class="math display">\[
\sum_i^n N_{i,k}(t) = 1,\ t \in [t_{k-1},t_{n+1}]
\]</span></p></li>
<li><p>可求导 <span class="math display">\[
N_{i,k}^{&#39;}(t) = \frac{k-1}{t_{i+k-1}-t_i}\cdot
N_{i,k-1}(t)+\frac{k-1}{t_{i+k}-t_{i+1}} \cdot N_{i+1,k-1}(t)
\]</span> 为什么分子是 k-1 呢？</p>
<p>因为 k 阶基函数是一个 k-1
次函数，在对其求导的时，其次数作为导数的系数，所以是 k-1</p></li>
<li><p>连续性</p>
<p><span class="math inline">\(P(t)\)</span> 在每一个重复度为 r
的节点上具有 <span class="math inline">\(C^{k-1+r}\)</span> 的连续性</p>
<p><span class="math inline">\(C^{k-1+r}\)</span> 表示具有 <span
class="math inline">\(k-1+r\)</span> 次（degree）连续。C 是 Continue
的首字母。</p></li>
<li><p>凸包性</p>
<p>一个 b 样条曲线被包围在其控制顶点的凸包内部。更精确地，对区间
$[t_i,t_{i+1}],k-1 i n $ 上的任何 t，<span
class="math inline">\(P(t)\)</span> 都在控制点 <span
class="math inline">\(P_{i-k+1},...,P_i\)</span> 的凸包内部。</p></li>
<li><p>分段多项式性质</p>
<p>在任何一个由相邻结点确定的节点区间（knot span）上，<span
class="math inline">\(P(t)\)</span> 是一个关于 t 的次数不超过 k
的多项式。</p></li>
<li><p>变差缩减性（Variation Diminishing Property）</p>
<p>任何曲一条直线与 B 样条曲线的交点数量不会超过该直线与 B
样条曲线的控制多边形的交点的数量。</p></li>
<li><p>几何不变性</p>
<p>曲线的形状和相对于控制点的位置不取决于坐标系的选择。</p></li>
<li><p>仿射不变性</p>
<p>将仿射变换作用于等式两边，等式依然成立 <span class="math display">\[
A[P(t)]= \sum_i^nA[P_i]N_{i,k}(t),t \in [t_{k-1},t_{n+1}]
\]</span></p></li>
<li><p>直线保持性</p>
<p>如果控制多边形退货成为一条直线，那么 B
样条曲线依然在这条直线上。</p></li>
</ol>
<h3 id="分类">分类</h3>
<p>根据起起终点是否重合，可分为:</p>
<ol type="1">
<li><p>开曲线</p>
<p>起终点不重合的曲线</p></li>
<li><p>闭曲线</p>
<p>起终点重合的曲线</p></li>
</ol>
<p>根据节点向量的分布，又可为分为：</p>
<ol type="1">
<li>均匀 b 样条曲线</li>
<li>非均匀 b 样条曲线</li>
<li>分段 Bezier 曲线</li>
<li>非均匀无理 b 样条曲线</li>
</ol>
<h3 id="均匀uniform-b-样条曲线">均匀（uniform） b 样条曲线</h3>
<p>当节点成等差数列均匀排列时，这样形成的 b 样条曲线就叫均匀 b
样条曲线。</p>
<p>例如：<span class="math inline">\(\vec{T} =
[0,1,2,3,4,5,6,7]\)</span></p>
<p>均匀 b 样条曲线有一个非常重要的特点，先上图：</p>
<p><img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220707133020413.png" style="max-width:400px"></p>
<p>均匀 b 样条曲线的起点位于 B 点垂直于AC两个点连线的 1/3 处，方向为
<span class="math inline">\(\vec{AC}\)</span>，终点位于 D 点垂直于 CE
两个点连线的 1/3，方向为 <span
class="math inline">\(\vec{CE}\)</span>。</p>
<p>均匀 b 样条的一个特点是：</p>
<p><strong>均匀 b 样条曲线一定通过非端点垂直于它前后两个点连线的 1/3
处，且其方向与前后两个点的连线相切。</strong></p>
<h3 id="准均匀quasi-uniform-b-样条曲线">准均匀（quasi-uniform） b
样条曲线</h3>
<p>k 阶准均匀 b 样条曲线有以下特点：</p>
<ol type="1">
<li>它的起终点分别为控制点的起终点</li>
<li>起始节点与终止节点都有 k 个重复度</li>
</ol>
<p><img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220707134509292.png" style="max-width:400px"></p>
<blockquote>
<p>小提示：</p>
<p>如果想让 b 样条曲线经过起终点，可以让起始节点都具有 k 个重复度</p>
</blockquote>
<h3 id="分段-bezier-曲线">分段 Bezier 曲线</h3>
<p>当 b 样条曲线具有如下特点时，它就是分段 Bezier 曲线：</p>
<ul>
<li>起终节点具有 k 个重复度</li>
<li>所有其它节点具有 k-1 个重复度</li>
</ul>
<h3 id="曲线包含线段">曲线包含线段</h3>
<p>如果需要在样条曲线中包含一条线段，只需要指定 k(阶数)
个控制顶点共线。</p>
<p>如果要保证插入的直线在控制点范围内是一条直线，还必须保证线段的首尾点分别具有
1 个重复度。</p>
<figure>
<img data-src="https://obs.uamazing.cn:52443/public/files/images/image-20220709181500332.png"
alt="image-20220709181500332" />
<figcaption aria-hidden="true">image-20220709181500332</figcaption>
</figure>
<p>左图是仅 3 个点共线，右图是 3 个点共线且共线的首尾点重复 1 次。</p>
<h3 id="曲线经过控制点">曲线经过控制点</h3>
<p>通过均匀 b 样条的特点可以知，如果 3 个点相同（这种重复3次的点，叫做 3
重点），则曲线经过该点。</p>
<p>因为 3 个点相同，所以它们的连线与垂线都位于这个点上。</p>
<h3 id="曲线与某直线l相切">曲线与某直线L相切</h3>
<p>如果希望某段曲线与某直线 L 相切，需满足以下条件：</p>
<ul>
<li><span class="math inline">\(P_i,P_{i+1},P_{i+2}\)</span>
都在直线上</li>
<li><span class="math inline">\(t_{i+3}\)</span> 重复度小于 2</li>
</ul>
<p>因此，如果想要曲线与两个控制点的连线相切，可以通过添加一个相同的控制点，将两个点变成
3 个点，因为有一个点是重复的，所以 3
个点必然在一条直线上，这样就达到了曲线与直线相切的条件了。</p>
<h3 id="闭曲线">闭曲线</h3>
<p>构件闭曲线的方式有很多种，此处只介绍一种简单的方法：重复起始节点法。</p>
<p>假设我们想要构建一个由 n+1 个控制点 <span
class="math inline">\([P_0,P1,...,P_n]\)</span> 定义的 k 次闭 B 样条曲线
<span class="math inline">\(C_t\)</span>。构建过程如下：</p>
<ol type="1">
<li>增加一个新控制点 <span
class="math inline">\(P_{n+1}=P_0\)</span>，因此控制点的数目是 <span
class="math inline">\(n+2\)</span>。</li>
<li>按开曲线方式，增加 n+k+1 个节点 <span
class="math inline">\([t_0,t_1,...,t_{n+k}]\)</span>。这些节点可以不需要是均匀的。</li>
<li>将前 p-1 节点复制到节点序列末尾，最终结果为：<span
class="math inline">\(t_0,t_1,...,t_n+k,t_0,t_1,...,t_{k-1}]\)</span></li>
</ol>
<p>通过对比开闭曲线，我们可以得到如下规律：</p>
<ul>
<li><p>开曲线：节点数量=控制点数量+阶数</p></li>
<li><p>闭曲线：节点数量=控制点数量+2x阶数</p></li>
</ul>
<blockquote>
<p>小提示：在 Microstation
软件中，生成闭曲线时不需要在末尾增加第一个点</p>
</blockquote>
<h2 id="非均匀有理b样条曲线nurbs">非均匀有理B样条曲线（NURBS）</h2>
<h3 id="order阶数">Order（阶数）</h3>
<p>NURBS曲线的 order 定义了影响曲线上任何给定点附近的控制点的数量。</p>
<p>这条曲线用比 order 小 1 次的多项式表示。 因此，order 为 2
时表示线性曲线，order 为 3 时表示二次曲线。</p>
<blockquote>
<p>控制点的个数必须大于或等于曲线的 order。</p>
</blockquote>
<p>在实践中，三次曲线是最常用的曲线。
五阶和六阶曲线有时是有用的，特别是对于获得连续的高阶导数，但高阶曲线实际上从未使用过，因为它们会导致内部数值问题，往往需要大量的计算时间。</p>
<h3 id="control-point-与-knot">Control Point 与 Knot</h3>
<p>这两个概念与 b 样条的概念是一样的</p>
<h3 id="weight">Weight</h3>
<p>nurbs 还有一个特殊的参数权重（weight），权重范围是
[0，100]，正常权重是 1，值越大，控制点对曲线影响越在，越靠近点，值为 0
值，控制点对曲线没有影响，相当于没有这个控制点。</p>
<h2 id="bézierb-splinenurbs-区别">Bézier、B-Spline、NURBS 区别</h2>
<p>Bezier
曲线中的每个控制点都会影响整个曲线的形状，而B样条中的控制点只会影响整个曲线的一部分，显然
B样条提供了更多的灵活性</p>
<p>Bezier和B样条都是多项式参数曲线，不能表示一些基本的曲线，比如圆，所以引入了
NURBS，即非均匀有理B样条来解决这个问题</p>
<p>Bezier 曲线只是 B样条的一个特例而已，而 B样条又是 NURBS
的一个特例，它们的关系可以图示为：</p>
<figure>
<img data-src="https://obs.uamazing.cn:52443/public/files/images/relationshipAmongCurves.png"
alt="relationshipAmongCurves" />
<figcaption aria-hidden="true">relationshipAmongCurves</figcaption>
</figure>
<h2
id="msbsplinecurvemicrostation中的对象">MSBsplineCurve（Microstation中的对象）</h2>
<p>它是一条非均匀有理B样条曲线，简称（NURBS）。</p>
<blockquote>
<p>MSBsplineCurve is a "Non uniform, rational Bspline curve".</p>
</blockquote>
<h3 id="pole-and-knot-counts">Pole and knot counts</h3>
<table>
<thead>
<tr class="header">
<th>曲线类型</th>
<th>关系</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Open curve （非闭合曲线）</td>
<td>knots = poles + order</td>
</tr>
<tr class="even">
<td>Closed (periodc) curve （闭合线）</td>
<td>knots = poles + 2 * order - 1</td>
</tr>
</tbody>
</table>
<h3 id="b样条曲线上的参数化位置">B样条曲线上的参数化位置</h3>
<p>有两种方法来确定 B 样条曲线的位置，分别是通过 Fraction 和 Knot
点。</p>
<table>
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 16%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr class="header">
<th>Convention</th>
<th>start value</th>
<th>end value</th>
<th>remarks</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Fraction position</td>
<td>一直是 0.0</td>
<td>一直是 1.0</td>
<td>这个值不是沿曲线线性变化的。如果想要获取等分点，需要先通过<code>FractionAtSignedDistance</code>
获取 Fraction，然后再通过 Fraction 去获取点。</td>
</tr>
<tr class="even">
<td>Knot postion</td>
<td>第一个激活的 Knot</td>
<td>最后一个激活的 Knot</td>
<td>“激活”的意思是除去(order-1)开头和结尾的Knot后剩余的中间 Knot</td>
</tr>
</tbody>
</table>
<p>The word Fraction or Knot in a method name indicates how the
arguments for that method are interpreted.</p>
<h3 id="通过控制点的-b-样条曲线">通过控制点的 b 样条曲线</h3>
<p>Microstation 中可以通过控制点创建 b
样条曲线，这个实现目前没有找到相关资料，今后发现了之后再更新本节。</p>
<h2 id="源代码">源代码</h2>
<p>本文使用的一些代码示例（基于 Microstation 平台）位于<a
target="_blank" rel="noopener" href="https://github.com/GalensGan/ArticleSourceCode/tree/master/ArticleSourceCode/Bspline">ArticleSourceCode-Bspline</a>
中。</p>
<h2 id="参考">参考</h2>
<p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1cW411a7yB">计算机图形学 13
和 14 - B 样条曲线-bilibili (建议先看完)</a></p>
<p><a
target="_blank" rel="noopener" href="https://www.zhihu.com/question/29565629">怎么理解贝塞尔曲线？</a></p>
<p><a
target="_blank" rel="noopener" href="https://zh.m.wikipedia.org/zh-hans/%E9%9D%9E%E5%9D%87%E5%8C%80%E6%9C%89%E7%90%86B%E6%A0%B7%E6%9D%A1">非均匀有理B样条-Wikipedia</a></p>
<p><a target="_blank" rel="noopener" href="http://www.whudj.cn/">Fun With Geometry</a></p>
<p><a
target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Non-uniform_rational_B-spline">NURBS-非均匀有理B样条</a></p>
<p><a
target="_blank" rel="noopener" href="https://pages.mtu.edu/~shene/COURSES/cs3621/NOTES/">Introduction
to Computing with Geometry Notes</a></p>
<p><a
target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/50626506">B-样条曲线入门</a></p>
<p><a
target="_blank" rel="noopener" href="https://blog.csdn.net/tuqu/article/details/5402645">B-样条曲线：系数计算</a></p>
<p><a
target="_blank" rel="noopener" href="https://juejin.cn/post/6844904170256859143">深入理解B样条曲线（上）</a></p>
<p><a
target="_blank" rel="noopener" href="https://pages.mtu.edu/~shene/COURSES/cs3621/NOTES/spline/B-spline/bspline-curve-closed.html">B-spline
Curves: Closed Curves</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>请我一杯咖啡吧！</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="https://i.loli.net/2021/08/13/JOw9cxomhBAZFW8.png" alt="明不知昔 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="https://i.loli.net/2021/08/13/U2s7gKn1zRw3uP4.png" alt="明不知昔 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="followme">
  <span>欢迎关注我的其它发布渠道</span>

  <div class="social-list">

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">公众号</span>
          </span>

          <img class="social-item-img" src="https://i.loli.net/2021/08/13/QMRtHE2b4czd7OA.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://www.jianshu.com/u/08760e791f9e">
            <span class="icon">
              <i class="fa fa-book-reader"></i>
            </span>

            <span class="label">简书</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Bentley%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91/" rel="tag"><i class="fa fa-tag"></i> Bentley二次开发</a>
              <a href="/tags/Bentley/" rel="tag"><i class="fa fa-tag"></i> Bentley</a>
              <a href="/tags/galens/" rel="tag"><i class="fa fa-tag"></i> galens</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/2022/1NF37FV.html" rel="prev" title="如何调用 Microstation 的消息管理器">
                  <i class="fa fa-chevron-left"></i> 如何调用 Microstation 的消息管理器
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/posts/2022/1C9ATGS.html" rel="next" title="几何继承关系层次图">
                  几何继承关系层次图 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">明不知昔</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">662k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">10:02</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/next-theme-pjax/0.6.0/pjax.min.js" integrity="sha256-vxLn1tSKWD4dqbMRyv940UYw4sXgMtYcK6reefzZrao=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/pjax.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>


  <script class="next-config" data-name="mermaid" type="application/json">{"enable":true,"theme":"forest","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mermaid/9.4.3/mermaid.min.js","integrity":"sha256-e0o3JYsdjqKajf9eOe22FhioYSz9WofRY4dLKo3F6do="}}</script>
  <script src="/js/third-party/tags/mermaid.js"></script>





  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"ams","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"galensgan","repo":"blog-comments","client_id":"63ece14861c297420892","client_secret":"731f0c050c35a3afee5aed41ca386decc768a3f0","admin_user":"galensgan","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"c60af4e6a9ecc654fb7105e993cb24a1"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
